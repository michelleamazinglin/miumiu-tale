!function(t){var i={};function e(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,o){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(o,n,function(i){return t[i]}.bind(null,n));return o},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/dist/",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);e(1),e(2)},function(t,i,e){},function(t,i){var e=null,o=[0,0,0,0,0,6,5,5,7,0,26,25,25,25,25,25,27,0,0,0,0,1,1,1,1,21,20,20,22,1,29,28,28,28,28,28,30,2,2,0,0,1,1,1,1,21,20,20,22,1,29,28,28,28,28,28,30,2,2,0,0,1,1,1,1,21,20,20,22,1,29,28,28,28,28,28,30,2,2,0,0,1,1,1,1,16,20,16,18,1,16,18,16,19,28,18,18,2,2,0,0,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,2,2,0,0,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,2,2,0,0,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,2,2,0,0,2,2,2,2,2,2,2,31,32,33,34,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,35,36,37,38,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,39,40,41,42,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,16,36,16,18,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],n=0,r=0,s={37:!1,38:!1,39:!1,40:!1},l=0,h=1,c=2,a=3,p=0,f=1,d={0:{color:"#793d4c",floor:p,sprite:[{x:0,y:0,w:40,h:40}]},1:{color:"#6df7b1",floor:f,sprite:[{x:40,y:0,w:40,h:40}]},2:{color:"#c97461",floor:f,sprite:[{x:80,y:0,w:40,h:40}]},4:{color:"#008df0",floor:2,sprite:[{x:160,y:0,w:40,h:40}]},5:{color:"#d77c4b",floor:p,sprite:[{x:120,y:0,w:40,h:40}]},6:{color:"#d77c4b",floor:p,sprite:[{x:120,y:40,w:40,h:40}]},7:{color:"#d77c4b",floor:p,sprite:[{x:80,y:40,w:40,h:40}]},10:{color:"#ccaa00",floor:p,sprite:[{x:240,y:40,w:40,h:40}]},11:{color:"#ccaa00",floor:p,sprite:[{x:280,y:40,w:40,h:40}]},12:{color:"#ccaa00",floor:p,sprite:[{x:320,y:40,w:40,h:40}]},13:{color:"#ccaa00",floor:p,sprite:[{x:240,y:80,w:40,h:40}]},14:{color:"#ccaa00",floor:p,sprite:[{x:280,y:80,w:40,h:40}]},15:{color:"#ccaa00",floor:p,sprite:[{x:320,y:80,w:40,h:40}]},16:{color:"#ccaa00",floor:p,sprite:[{x:240,y:120,w:40,h:40}]},17:{color:"#ccaa00",floor:p,sprite:[{x:280,y:120,w:40,h:40}]},18:{color:"#ccaa00",floor:p,sprite:[{x:320,y:120,w:40,h:40}]},19:{color:"#ccaa00",floor:p,sprite:[{x:360,y:120,w:40,h:40}]},20:{color:"#d77c4b",floor:f,sprite:[{x:40,y:40,w:40,h:40}]},21:{color:"#d77c4b",floor:p,sprite:[{x:80,y:80,w:40,h:40}]},22:{color:"#d77c4b",floor:p,sprite:[{x:120,y:80,w:40,h:40}]},25:{color:"#d77c4b",floor:p,sprite:[{x:320,y:160,w:40,h:40}]},26:{color:"#d77c4b",floor:p,sprite:[{x:240,y:160,w:40,h:40}]},27:{color:"#d77c4b",floor:p,sprite:[{x:280,y:160,w:40,h:40}]},28:{color:"#d77c4b",floor:f,sprite:[{x:280,y:200,w:40,h:40}]},29:{color:"#d77c4b",floor:p,sprite:[{x:360,y:160,w:40,h:40}]},30:{color:"#d77c4b",floor:p,sprite:[{x:240,y:200,w:40,h:40}]},31:{color:"#d77c4b",floor:p,sprite:[{x:320,y:200,w:40,h:40}]},32:{color:"#d77c4b",floor:p,sprite:[{x:360,y:200,w:40,h:40}]},33:{color:"#d77c4b",floor:p,sprite:[{x:400,y:200,w:40,h:40}]},34:{color:"#d77c4b",floor:p,sprite:[{x:440,y:200,w:40,h:40}]},35:{color:"#d77c4b",floor:p,sprite:[{x:320,y:240,w:40,h:40}]},36:{color:"#d77c4b",floor:f,sprite:[{x:360,y:240,w:40,h:40}]},37:{color:"#d77c4b",floor:p,sprite:[{x:400,y:240,w:40,h:40}]},38:{color:"#d77c4b",floor:p,sprite:[{x:440,y:240,w:40,h:40}]},39:{color:"#d77c4b",floor:p,sprite:[{x:320,y:280,w:40,h:40}]},40:{color:"#d77c4b",floor:f,sprite:[{x:360,y:280,w:40,h:40}]},41:{color:"#d77c4b",floor:f,sprite:[{x:400,y:280,w:40,h:40}]},42:{color:"#d77c4b",floor:p,sprite:[{x:440,y:280,w:40,h:40}]}},u=0,y=1,w={1:{name:"Flower",sprite:[{x:40,y:180,w:40,h:20}],offset:[0,0],collision:u,zIndex:1},2:{name:"fence",sprite:[{x:40,y:200,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},3:{name:"Tree",sprite:[{x:80,y:160,w:80,h:80}],offset:[-20,-20],collision:y,zIndex:3},4:{name:"mashrooms",sprite:[{x:40,y:160,w:40,h:20}],offset:[0,0],collision:u,zIndex:1},5:{name:"Pig Shop",sprite:[{x:160,y:160,w:80,h:80}],offset:[-20,-20],collision:y,zIndex:3},6:{name:"donuts",sprite:[{x:360,y:0,w:80,h:115}],offset:[0,0],collision:u,zIndex:1},7:{name:"cooking",sprite:[{x:160,y:80,w:80,h:80}],offset:[0,0],collision:u,zIndex:1},8:{name:"carpet",sprite:[{x:0,y:80,w:80,h:40}],offset:[0,0],collision:u,zIndex:1},9:{name:"desk",sprite:[{x:0,y:40,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},10:{name:"chair",sprite:[{x:320,y:0,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},11:{name:"Tree Plant",sprite:[{x:40,y:120,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},12:{name:"drum",sprite:[{x:0,y:240,w:80,h:40}],offset:[0,0],collision:y,zIndex:1},13:{name:"instruments",sprite:[{x:80,y:240,w:120,h:80}],offset:[0,0],collision:y,zIndex:1},14:{name:"BookShelf",sprite:[{x:200,y:240,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},15:{name:"saxophone",sprite:[{x:240,y:240,w:40,h:40}],offset:[0,0],collision:y,zIndex:1},16:{name:"Right Facing Chair",sprite:[{x:200,y:280,w:40,h:40}],offset:[0,0],collision:y,zIndex:1}},m=null,g=!1,b=new v;function v(){this.tileFrom=[1,1],this.tileTo=[9,11],this.timeMoved=0,this.delayMove=700,this.dimensions=[40,40],this.position=[45,45],this.direction=l,this.sprites={},this.sprites[l]=[{x:0,y:120,w:30,h:30}],this.sprites[h]=[{x:0,y:150,w:30,h:30}],this.sprites[c]=[{x:0,y:180,w:30,h:30}],this.sprites[a]=[{x:0,y:210,w:30,h:30}]}v.prototype.location=function(t,i){this.tileFrom=[t,i],this.tileTo=[t,i],this.position=[40*t+(40-this.dimensions[0])/2,40*i+(40-this.dimensions[1])/2]},v.prototype.processMovement=function(t){if(this.tileFrom[0]==this.tileTo[0]&&this.tileFrom[1]==this.tileTo[1])return!1;if(t-this.timeMoved>=this.delayMove)this.location(this.tileTo[0],this.tileTo[1]),null!=T.map[z(this.tileTo[0],this.tileTo[1])].eventEnter&&T.map[z(this.tileTo[0],this.tileTo[1])].eventEnter(this);else{if(this.position[0]=40*this.tileFrom[0]+(40-this.dimensions[0])/2,this.position[1]=40*this.tileFrom[1]+(40-this.dimensions[1])/2,this.tileTo[0]!=this.tileFrom[0]){var i=40/this.delayMove*(t-this.timeMoved);this.position[0]+=this.tileTo[0]<this.tileFrom[0]?0-i:i}if(this.tileTo[1]!=this.tileFrom[1]){var e=40/this.delayMove*(t-this.timeMoved);this.position[1]+=this.tileTo[1]<this.tileFrom[1]?0-e:e}this.position[0]=Math.round(this.position[0]),this.position[1]=Math.round(this.position[1])}return!0},v.prototype.placesCanGo=function(t,i){if(t<0||t>=20||i<0||i>=20)return!1;if(d[o[z(t,i)]].floor!=f)return!1;if(null!=T.map[z(t,i)].object){var e=T.map[z(t,i)].object;if(w[e.type].collision==y)return!1}return!0},v.prototype.canGoUp=function(){return this.placesCanGo(this.tileFrom[0],this.tileFrom[1]-1)},v.prototype.canGoDown=function(){return this.placesCanGo(this.tileFrom[0],this.tileFrom[1]+1)},v.prototype.canGoLeft=function(){return this.placesCanGo(this.tileFrom[0]-1,this.tileFrom[1])},v.prototype.canGoRight=function(){return this.placesCanGo(this.tileFrom[0]+1,this.tileFrom[1])},v.prototype.goLeft=function(t){this.tileTo[0]-=1,this.timeMoved=t,this.direction=a},v.prototype.goRight=function(t){this.tileTo[0]+=1,this.timeMoved=t,this.direction=h},v.prototype.goUp=function(t){this.tileTo[1]-=1,this.timeMoved=t,this.direction=l},v.prototype.goDown=function(t){this.tileTo[1]+=1,this.timeMoved=t,this.direction=c};var M={screen:[0,0],startingPoint:[0,0],endingPoint:[0,0],offset:[0,0],update:function(t,i){this.offset[0]=Math.floor(this.screen[0]/2-t),this.offset[1]=Math.floor(this.screen[1]/2-i);var e=[Math.floor(t/40),Math.floor(i/40)];this.startingPoint[0]=e[0]-Math.ceil(this.screen[0]/2/40)-1,this.startingPoint[1]=e[1]-Math.ceil(this.screen[1]/2/40)-1,this.startingPoint[0]<=-1&&(this.startingPoint[0]=0),this.startingPoint[1]<=-1&&(this.startingPoint[1]=0),this.endingPoint[0]=e[0]+1+Math.ceil(this.screen[0]/2/40),this.endingPoint[1]=e[1]+1+Math.ceil(this.screen[1]/2/40),this.endingPoint[0]>=20&&(this.endingPoint[0]=19),this.endingPoint[1]>=20&&(this.endingPoint[1]=19)}},T=new I,F=[{x:5,y:0,w:4,h:5,data:[10,11,11,12,13,14,14,15,16,18,16,18,16,18,16,18,16,17,16,18]},{x:10,y:0,w:7,h:5,data:[10,11,11,11,11,12,12,13,15,13,14,14,15,15,16,18,16,19,19,18,18,16,18,16,19,19,18,18,16,18,16,19,17,18,18]},{x:8,y:8,w:4,h:4,data:[10,11,11,12,13,14,14,15,16,18,16,18,16,17,16,18]}];function A(t,i,e){this.x=t,this.y=i,this.type=e,this.building=null,this.buildingType=0,this.eventEnter=null,this.object=null}function I(){this.map=[],this.w=0,this.h=0,this.levels=4}function P(t){this.x=0,this.y=0,this.type=t}function z(t,i){return t+20*i}function j(t,i,e,o){if(!o)return t[0];for(x in e%=i,t)if(t[x].end>=e)return t[x]}function C(){if(null!=e)if(g){var t=Date.now(),i=Math.floor(Date.now()/1e3);i!=n?(n=i,r,r=1):r++,b.processMovement(t)||(s[38]&&b.canGoUp()?b.goUp(t):s[40]&&b.canGoDown()?b.goDown(t):s[37]&&b.canGoLeft()?b.goLeft(t):s[39]&&b.canGoRight()&&b.goRight(t)),M.update(b.position[0]+b.dimensions[0]/2,b.position[1]+b.dimensions[1]/2);var o=T.map[z(b.tileFrom[0],b.tileFrom[1])].building,l=T.map[z(b.tileTo[0],b.tileTo[1])].building;e.fillStyle="#000000",e.fillRect(0,0,M.screen[0],M.screen[1]);for(var h=0;h<T.levels;h++){for(var c=M.startingPoint[1];c<=M.endingPoint[1];++c)for(var a=M.startingPoint[0];a<=M.endingPoint[0];++a){if(0==h){var p=d[T.map[z(a,c)].type];e.drawImage(m,p.sprite[0].x,p.sprite[0].y,p.sprite[0].w,p.sprite[0].h,M.offset[0]+40*a,M.offset[1]+40*c,40,40)}var f=T.map[z(a,c)].object;if(null!=f&&w[f.type].zIndex==h){var u=w[f.type];e.drawImage(m,u.sprite[0].x,u.sprite[0].y,u.sprite[0].w,u.sprite[0].h,M.offset[0]+40*a+u.offset[0],M.offset[1]+40*c+u.offset[1],u.sprite[0].w,u.sprite[0].h)}2==h&&0!=T.map[z(a,c)].buildingType&&T.map[z(a,c)].building!=o&&T.map[z(a,c)].building!=l&&(tile=d[T.map[z(a,c)].buildingType],x=j(tile.sprite,tile.spritetimeLast,tile.animation),e.drawImage(m,x.x,x.y,x.w,x.h,M.offset[0]+40*a,M.offset[1]+40*c,40,40))}if(1==h){var y=b.sprites[b.direction];e.drawImage(m,y[0].x,y[0].y,y[0].w,y[0].h,M.offset[0]+b.position[0],M.offset[1]+b.position[1],b.dimensions[0],b.dimensions[1])}}var x=b.sprites[b.direction];e.drawImage(m,x[0].x,x[0].y,x[0].w,x[0].h,M.offset[0]+b.position[0],M.offset[1]+b.position[1],b.dimensions[0],b.dimensions[1]),t,requestAnimationFrame(C)}else requestAnimationFrame(C)}I.prototype.buildMapFromData=function(t,i,e){if(this.w=i,this.h=e,t.length!=i*e)return!1;this.map.length=0;for(var o=0;o<e;o++)for(var n=0;n<i;n++)this.map.push(new A(n,o,t[n+i*o]));return!0},I.prototype.addBuildings=function(t){for(var i in t){var e=t[i];if(!(e.x<0||e.y<0||e.x>=this.w||e.y>=this.h||e.x+e.w>this.w||e.y+e.h>this.h||e.data.length!=e.w*e.h))for(var o=0;o<e.h;o++)for(var n=0;n<e.w;n++){var r=(e.y+o)*this.w+e.x+n;this.map[r].building=e,this.map[r].buildingType=e.data[o*e.w+n]}}},P.prototype.placeAt=function(t,i){T.map[z(this.x,this.y)].object==this&&(T.map[z(this.x,this.y)].object=null),this.x=t,this.y=i,T.map[z(t,i)].object=this},window.onload=function(){e=document.getElementById("miumiuTale").getContext("2d"),requestAnimationFrame(C),window.addEventListener("keydown",(function(t){t.keyCode>=37&&t.keyCode<=40&&(s[t.keyCode]=!0)})),window.addEventListener("keyup",(function(t){t.keyCode>=37&&t.keyCode<=40&&(s[t.keyCode]=!1)})),M.screen=[document.getElementById("miumiuTale").width,document.getElementById("miumiuTale").height],(m=new Image).onerror=function(){e=null,alert("Failed loading gametile.")},m.onload=function(){g=!0},m.src="src/images/tilesetestt.png",T.buildMapFromData(o,20,20),T.addBuildings(F),T.map[42].eventEnter=function(){console.log("Entered tile 2,2")},new P(2).placeAt(9,1),new P(1).placeAt(5,5),new P(1).placeAt(7,5),new P(1).placeAt(8,5),new P(3).placeAt(4,6),new P(3).placeAt(9,6),new P(3).placeAt(7,6),new P(3).placeAt(12,6),new P(4).placeAt(2,4),new P(4).placeAt(9,2),new P(5).placeAt(3,4),new P(6).placeAt(5,0),new P(7).placeAt(7,0),new P(8).placeAt(7,2),new P(9).placeAt(8,3),new P(10).placeAt(8,2),new P(16).placeAt(12,2),new P(11).placeAt(5,3),new P(12).placeAt(15,1),new P(13).placeAt(12,0),new P(14).placeAt(10,1),new P(14).placeAt(10,2),new P(15).placeAt(13,2)}}]);
//# sourceMappingURL=main.js.map