{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/scripts/map.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ctx","gameMap","currentSecond","frameCount","heldKeys","37","38","39","40","directions","floorTypes","tileTypes","0","colour","floor","sprite","x","y","w","h","1","2","3","4","10","11","12","13","14","15","16","17","18","collisions","objectTypes","offset","collision","zIndex","gametile","artLoaded","miumiu","MiuMiu","this","tileFrom","tileTo","timeMoved","delayMove","dimensions","position","direction","sprites","location","processMovement","mapTileData","map","toIndex","eventEnter","difference","Math","round","placesCanGo","type","canGoUp","canGoDown","canGoLeft","canGoRight","goLeft","goRight","goUp","goDown","camera","screen","startingPoint","endingPoint","update","offsetX","offsetY","tile","ceil","mapWidth","mapHeight","TileMap","buildingsLocation","data","Tile","tileX","tileY","tileType","building","buildingType","levels","GameObjects","nt","getFrame","timeLast","time","animation","end","drawGame","currentFrameTime","Date","now","sec","miumiuBuilding1","miumiuBuilding2","fillStyle","fillRect","z","drawImage","ot","spritetimeLast","requestAnimationFrame","buildMapFromData","tileId","length","push","addBuildings","buildings","tileIdx","placeAt","nx","ny","window","onload","document","getElementById","getContext","addEventListener","e","keyCode","width","height","Image","onerror","alert","src","console","log"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,SAIjBlC,EAAoBA,EAAoBmC,EAAI,G,+BClFrD,kB,gCCGA,IAAIC,EAAM,KAGNC,EAAU,CACb,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACzD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACtD,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAC5D,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import \"./styles/index.scss\";\nimport \"./scripts/map\";\n\n\n\n","// i want a camera following the char around the map\n\n\nlet ctx = null;\n\n// create a map with 10*10 tile\nlet gameMap = [\n\t0, 0, 0, 0, 0, 3, 3, 3, 3, 0, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0,\n\t0, 1, 1, 1, 1, 3, 2, 2, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 3, 2, 2, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 3, 2, 2, 3, 1, 3, 2, 2, 2, 2, 3, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 3, 2, 3, 3, 1, 3, 3, 3, 3, 2, 3, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 0,\n    0, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0,\n\t4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,\n\t4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4\n];\n// 每个地砖多少pixel\nlet tileWidth = 40;\nlet tileHeight = 40;\n// 地图大小就是10*10\nlet mapWidth = 20;\nlet mapHeight = 20;\n// framerate\nlet currentSecond = 0;\nlet frameCount = 0;\nlet framesLastSecond = 0;\nlet lastFrameTime = 0;\n\n\n// keyCode : boolean to tell us which one are pressed\nlet heldKeys = {\n    // 37: left\n    37 : false,\n    // 38: up\n    38 : false,\n    // 39: right\n    39 : false,\n    // 40: down\n    40 : false\n    // 32: space\n};\n\nlet directions = {\n\tup\t: 0,\n\tright: 1,\n\tdown: 2,\n\tleft: 3\n};\n\n\n// 地板种类\nlet floorTypes = {\n    solid: 0,\n    path: 1,\n    ocean: 2\n};\n\n// 数字（gameMap）对应上颜色和地板种类\n// 0:墙壁 1:草地 2:陆地 3:房子 4: 水\nlet tileTypes = {\n\t0 : { colour: \"#793d4c\", floor: floorTypes.solid, sprite:[{x:0,y:0,w:40,h:40}] },\n\t1 : { colour: \"#6df7b1\", floor: floorTypes.path, sprite:[{x:40,y:0,w:40,h:40}] },\n\t2 : { colour: \"#c97461\", floor: floorTypes.path, sprite:[{x:80,y:0,w:40,h:40}]\t},\n\t3 : { colour: \"#d77c4b\", floor: floorTypes.solid, sprite:[{x:120,y:0,w:40,h:40}] },\n    4 : { colour: \"#008df0\", floor: floorTypes.ocean, sprite:[{x:160,y:0,w:40,h:40}] },\n    10 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:240,y:40,w:40,h:40}]},\n    11 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:280,y:40,w:40,h:40}]},\n    12 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:320,y:40,w:40,h:40}]},\n    13 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:240,y:80,w:40,h:40}]},\n    14 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:280,y:80,w:40,h:40}]},\n    15 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:320,y:80,w:40,h:40}]},\n    16 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:240,y:120,w:40,h:40}]},\n    17 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:280,y:120,w:40,h:40}]},\n    18 : { colour:\"#ccaa00\", floor:floorTypes.solid, sprite:[{x:320,y:120,w:40,h:40}]}\n};\n\nlet collisions = {\n\tnone\t\t: 0,\n\tsolid\t\t: 1\n};\n\nlet objectTypes = {\n\t1 : {\n\t\tname : \"Flower\",\n\t\tsprite : [{x:40,y:180,w:40,h:20}],\n\t\toffset : [0,0],\n\t\tcollision : collisions.none,\n\t\tzIndex : 1\n\t},\n\t2 : {\n\t\tname : \"fence\",\n\t\tsprite : [{x:40,y:200,w:40,h:40}],\n\t\toffset : [0,0],\n\t\tcollision : collisions.solid,\n\t\tzIndex : 1\n\t},\n\t3 : {\n\t\tname : \"Tree\",\n\t\tsprite : [{x:80,y:160,w:80,h:80}],\n\t\toffset : [-20,-20],\n\t\tcollision : collisions.solid,\n\t\tzIndex : 3\n    },\n    4 : {\n\t\tname : \"mashrooms\",\n\t\tsprite : [{x:40,y:160,w:40,h:20}],\n\t\toffset : [0,0],\n\t\tcollision : collisions.none,\n\t\tzIndex : 1\n\t},\n};\n\n\n// 物品\nlet itemTypes = {\n    1 : {\n\t\tname : \"coconut\",\n\t\tmaxStack : 5,\n\t\tsprite : [{x:240,y:0,w:40,h:40}],\n\t\toffset : [0,0]\n    },\n    2 : {\n\t\tname : \"strawberry\",\n\t\tmaxStack : 5,\n\t\tsprite : [{x:280,y:0,w:40,h:40}],\n\t\toffset : [0,0]\n\t}\n};\n\n\n\nlet gametile = null, gametileURL = \"src/images/tilesetestt.png\", artLoaded = false;\n\n\n\n// 创建一个角色 (miumiu)\nlet miumiu = new MiuMiu();\n// 加更多角色⬇\nfunction MiuMiu() {\n    this.tileFrom\t= [1,1];\n    // miumiu的位置\n    this.tileTo\t\t= [6,6];\n    // time in millseconds\n    this.timeMoved\t= 0;\n    this.delayMove\t= 700;\n\tthis.dimensions\t= [40,40];\n    this.position\t= [45,45];\n    \n    this.direction\t= directions.up;\n\tthis.sprites = {};\n\tthis.sprites[directions.up]\t\t= [{x:0,y:120,w:30,h:30}];\n\tthis.sprites[directions.right]\t= [{x:0,y:150,w:30,h:30}];\n\tthis.sprites[directions.down]\t= [{x:0,y:180,w:30,h:30}];\n\tthis.sprites[directions.left]\t= [{x:0,y:210,w:30,h:30}];\n}\n\n\n// 把角色放在地砖上\nMiuMiu.prototype.location = function(x, y) {\n\tthis.tileFrom\t= [x,y];\n    this.tileTo\t\t= [x,y];\n    // x and y position of the tile. update the tileFrom and tileTo properties to the new tile coordinates\n    // calculates the pixel position of the characyer use below\n\tthis.position\t= [(( tileWidth * x )+( (tileWidth - this.dimensions[0]) / 2 )),\n\t\t(( tileHeight * y )+( (tileHeight - this.dimensions[1]) / 2 ))];\n};\n\n// 根据每个帧数找到角色位置\nMiuMiu.prototype.processMovement = function(t) {\n    // if char tileTo == tileFrom char is not moving, so return false\n\tif( this.tileFrom[0] == this.tileTo[0] && this.tileFrom[1] == this.tileTo[1]) { return false; }\n    // if the amount of time passed since char began its current move >= the time for char to move 1 tile. we set position using location function\n    // aka: if char still moving\n\tif((t - this.timeMoved) >= this.delayMove) {\n        this.location(this.tileTo[0], this.tileTo[1]);\n        if(mapTileData.map[toIndex(this.tileTo[0], this.tileTo[1])].eventEnter!=null)\n\t\t{\n\t\t\tmapTileData.map[toIndex(this.tileTo[0], this.tileTo[1])].eventEnter(this);\n        }\n\t} else {\n        // current position on canvas\n\t\tthis.position[0] = (this.tileFrom[0] * tileWidth) + ((tileWidth-this.dimensions[0])/2);\n\t\tthis.position[1] = (this.tileFrom[1] * tileHeight) + ((tileHeight-this.dimensions[1])/2);\n\n        // if char is moving on x coordinate, calculate pixels\n\t\tif(this.tileTo[0] != this.tileFrom[0]) {\n            // difference = distance moved\n            // 加减移动的地砖到角色的位子\n\t\t\tlet difference = (tileWidth / this.delayMove) * (t - this.timeMoved);\n\t\t\tthis.position[0]+= (this.tileTo[0] < this.tileFrom[0] ? 0 - difference : difference);\n\t\t}\n\t    if(this.tileTo[1] != this.tileFrom[1]) {\n\t\t\tlet difference = (tileHeight / this.delayMove) * (t-this.timeMoved);\n\t\t\tthis.position[1]+= (this.tileTo[1]<this.tileFrom[1] ? 0 - difference : difference);\n        }\n        // round x & y to whole number 需要整数\n\t\tthis.position[0] = Math.round(this.position[0]);\n\t\tthis.position[1] = Math.round(this.position[1]);\n    }\n    // true = char is currently moving\n\treturn true;\n}\n\n\n// if char can move in a specific direc\nMiuMiu.prototype.placesCanGo = function(x, y) {\n    // if x and y is in map bound\n    if(x < 0 || x >= mapWidth || y < 0 || y >= mapHeight) { return false; }\n    // if the tile is path tile (only move if its a path)\n        if(tileTypes[gameMap[toIndex(x,y)]].floor!=floorTypes.path) { return false; }\n        if(mapTileData.map[toIndex(x,y)].object!=null)\n\t{\n\t\tlet o = mapTileData.map[toIndex(x,y)].object;\n\t\tif(objectTypes[o.type].collision==collisions.solid)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n};\nMiuMiu.prototype.canGoUp = function() { return this.placesCanGo(this.tileFrom[0], this.tileFrom[1] - 1); };\nMiuMiu.prototype.canGoDown = function() { return this.placesCanGo(this.tileFrom[0], this.tileFrom[1] + 1); };\nMiuMiu.prototype.canGoLeft = function() { return this.placesCanGo(this.tileFrom[0]-1, this.tileFrom[1]); };\nMiuMiu.prototype.canGoRight = function() { return this.placesCanGo(this.tileFrom[0]+1, this.tileFrom[1]); };\n\nMiuMiu.prototype.goLeft = function(t) { this.tileTo[0]-= 1; this.timeMoved = t; this.direction = directions.left; };\nMiuMiu.prototype.goRight = function(t) { this.tileTo[0]+= 1; this.timeMoved = t; this.direction = directions.right; };\nMiuMiu.prototype.goUp = function(t) { this.tileTo[1]-= 1; this.timeMoved = t; this.direction = directions.up; };\nMiuMiu.prototype.goDown = function(t) { this.tileTo[1]+= 1; this.timeMoved = t; this.direction = directions.down; };\n\n\n\n// create a camera object\nlet camera = {\n    screen: [0,0],\n    // 画面左上角\n    startingPoint: [0,0],\n    // 画面右下角\n    endingPoint: [0,0],\n    // 误差\n    offset: [0,0],\n    // update function, x y is our center area\n    update: function(offsetX, offsetY) {\n        // offset: half the canvas width || height (round down to whole num)\n\t\tthis.offset[0] = Math.floor((this.screen[0]/2) - offsetX);\n        this.offset[1] = Math.floor((this.screen[1]/2) - offsetY);\n\n        // 地砖在地图上的位置\n        let tile = [ Math.floor(offsetX / tileWidth), Math.floor(offsetY / tileHeight) ];\n        //  计算第一个地砖位置在x线上： 最大地砖数量 - 屏幕的一半\n        //  多减去1这样地砖可以show一半在屏幕上\n        this.startingPoint[0] = tile[0] - Math.ceil((this.screen[0]/2) / tileWidth)  - 1;\n\t\tthis.startingPoint[1] = tile[1] - Math.ceil((this.screen[1]/2) / tileHeight)  - 1;\n\n        // 确保x和y都大于0要么会在地图外\n        if(this.startingPoint[0] <= -1) { this.startingPoint[0] = 0; }\n\t\tif(this.startingPoint[1] <= -1) { this.startingPoint[1] = 0; }\n\n        this.endingPoint[0] = tile[0] + 1 + Math.ceil((this.screen[0]/2) / tileWidth);\n\t\tthis.endingPoint[1] = tile[1] + 1 + Math.ceil((this.screen[1]/2) / tileHeight);\n\n\t\tif(this.endingPoint[0] >= mapWidth) { this.endingPoint[0] = mapWidth -1; }\n\t\tif(this.endingPoint[1] >= mapHeight) { this.endingPoint[1] = mapHeight - 1; }\n        }\n};\n\n\n// buildings\n\nlet mapTileData = new TileMap();\nlet buildingsLocation = [\n\t{ x:5, y:0, w:4, h:5, data: [\n\t\t10, 11, 11, 12,\n        13, 14, 14, 15,\n        16, 18, 16, 18,\n        16, 18, 16, 18,\n        16, 17, 16, 18\n\t]},\n\t{ x:10, y:0, w:6, h:5, data: [\n\t\t10, 11, 11, 11, 11, 12,\n        16, 18, 16, 18, 17, 18,\n        16, 18, 16, 18, 17, 18,\n        16, 18, 16, 18, 17, 18,\n        16, 18, 16, 18, 17, 18\n\t]},\n\t{ x:8, y:8, w:4, h:4, data: [\n        10, 11, 11, 12,\n        13, 14, 14, 15,\n        16, 18, 16, 18,\n        16, 17, 16, 18\n\t]}\n];\n\n// stores information for each map tile\nfunction Tile(tileX, tileY, tileType)\n{\n    // tileY, tileX = the position of the tile on the map\n\tthis.x\t\t\t= tileX;\n\tthis.y\t\t\t= tileY;\n\tthis.type\t\t= tileType;\n\tthis.building\t\t= null;\n    this.buildingType\t= 0;\n    //  pointer to a function to execute when a MiuMiu has completed moving on to this tile\n    this.eventEnter\t= null;\n    this.object\t\t= null;\n\n}\n\n// 储存管理地图数据\nfunction TileMap() {\n\tthis.map\t= [];\n\tthis.w\t\t= 0;\n    this.h\t\t= 0;\n\tthis.levels\t= 4;\n}\n\nTileMap.prototype.buildMapFromData = function(tileId, w, h) {\n\tthis.w\t\t= w;\n    this.h\t\t= h;\n\n    if(tileId.length!=(w * h)) { return false; }\n\t\n    this.map.length\t= 0;\n    \tfor(let y = 0; y < h; y++) {\n\t\t    for(let x = 0; x < w; x++) {\n\t\t\tthis.map.push( new Tile(x, y, tileId[ (x + (w * y))]) );\n\t\t}\n    }\n    return true;\n};\n\n\nTileMap.prototype.addBuildings = function(buildings)\n{\n\tfor(let i in buildings)\n\t{\n        let building = buildings[i];\n        if(building.x < 0 || building.y < 0 || building.x >= this.w || building.y >= this.h ||\t(building.x+building.w)>this.w || (building.y+building.h)>this.h || building.data.length!=(building.w*building.h)) {\n\t\t\tcontinue;\n        }\n        for(let y = 0; y < building.h; y++) {\n\t\t\tfor(let x = 0; x < building.w; x++) {\n                let tileIdx = (((building.y + y) * this.w)+building.x + x);\n                this.map[tileIdx].building = building;\n\t\t\t\tthis.map[tileIdx].buildingType = building.data[( (y * building.w) + x)];\n\t\t\t}\n\t\t}\n\t}\n};\n\n// 物品摆放\nfunction GameObjects(nt)\n{\n\tthis.x\t\t= 0;\n\tthis.y\t\t= 0;\n\tthis.type\t= nt;\n}\n\nGameObjects.prototype.placeAt = function(nx, ny)\n{\n\tif(mapTileData.map[toIndex(this.x, this.y)].object==this)\n\t{\n\t\tmapTileData.map[toIndex(this.x, this.y)].object = null;\n    }\n    this.x = nx;\n\tthis.y = ny;\n\t\n\tmapTileData.map[toIndex(nx, ny)].object = this;\n};\n\n\n\n// convert x, y into index in gameMap arr\nfunction toIndex(x, y) {\n\treturn(x + (mapWidth * y));\n}\n\nfunction getFrame(sprite, timeLast, time, animation)\n{\n\tif(!animation) { return sprite[0]; }\n\ttime = time % timeLast;\n\n\tfor(x in sprite) {\n\t\tif(sprite[x].end>=time) { return sprite[x]; }\n\t}\n}\n\n// 界面load完，开始loop\nwindow.onload = function() {\n\tctx = document.getElementById(\"miumiuTale\").getContext(\"2d\");\n\trequestAnimationFrame(drawGame);\n    \n    // add eventListeners for the keydowna and keyup\n\twindow.addEventListener(\"keydown\", function(e) {\n\t\tif(e.keyCode>=37 && e.keyCode<=40) { heldKeys[e.keyCode] = true; }\n\t});\n\twindow.addEventListener(\"keyup\", function(e) {\n\t\tif(e.keyCode>=37 && e.keyCode<=40) { heldKeys[e.keyCode] = false; }\n    });\n\n    // canvas尺寸 保存到 相机\n    camera.screen = [document.getElementById(\"miumiuTale\").width,\n        document.getElementById(\"miumiuTale\").height];\n        \n    gametile = new Image();\n\tgametile.onerror = function()\n\t{\n\t\tctx = null;\n\t\talert(\"Failed loading gametile.\");\n\t};\n\tgametile.onload = function() { artLoaded = true; };\n    gametile.src = gametileURL;\n    \n    mapTileData.buildMapFromData(gameMap, mapWidth, mapHeight);\n\tmapTileData.addBuildings(buildingsLocation);\n\tmapTileData.map[((2*mapWidth)+2)].eventEnter = function()\n    { console.log(\"Entered tile 2,2\"); };\n    \n    \n\tlet fence1 = new GameObjects(2); fence1.placeAt(9, 1);\n    let fence2 = new GameObjects(2); fence2.placeAt(9, 2);\n    \n    let flower1 = new GameObjects(1); flower1.placeAt(5, 5);\n    let flower2 = new GameObjects(1); flower2.placeAt(7, 5);\n    let flower3 = new GameObjects(1); flower3.placeAt(8, 5);\n    \n\tlet tree1 = new GameObjects(3); tree1.placeAt(4, 6);\n\tlet tree2 = new GameObjects(3); tree2.placeAt(9, 6);\n\tlet tree3 = new GameObjects(3); tree3.placeAt(7, 6);\t\n    let tree4 = new GameObjects(3); tree4.placeAt(12, 6);\n    \n    let mashroom1 = new GameObjects(4); mashroom1.placeAt(2,2);\n\n};\n\n\n// main function\nfunction drawGame()\n{\n    if (ctx == null) { return; }\n    if (!artLoaded) { requestAnimationFrame(drawGame); return; }\n\n\tlet currentFrameTime = Date.now();\n    // framecount \n\tlet sec = Math.floor(Date.now() / 1000);\n\tif(sec != currentSecond){\n\t\tcurrentSecond = sec;\n\t\tframesLastSecond = frameCount;\n\t\tframeCount = 1;\n\t}\n\telse { frameCount++; }\n\n    // miumiu movement\n\tif(!miumiu.processMovement(currentFrameTime)) {\n\t\tif(heldKeys[38] && miumiu.canGoUp()){ \n            miumiu.goUp(currentFrameTime); \n        } else if (heldKeys[40] && miumiu.canGoDown()) { \n            miumiu.goDown(currentFrameTime); \n        } else if(heldKeys[37] && miumiu.canGoLeft()) { \n            miumiu.goLeft(currentFrameTime); \n        } else if(heldKeys[39] && miumiu.canGoRight()) { \n            miumiu.goRight(currentFrameTime); \n        }\n    }\n\n    // camera跟着miumiu走\n        camera.update(miumiu.position[0] + (miumiu.dimensions[0] / 2),\n            miumiu.position[1] + (miumiu.dimensions[1]/2));\n\n\t    let miumiuBuilding1 = mapTileData.map[toIndex(\n\t\tmiumiu.tileFrom[0], miumiu.tileFrom[1])].building;\n\t    let miumiuBuilding2 = mapTileData.map[toIndex(\n\t\tmiumiu.tileTo[0], miumiu.tileTo[1])].building;\n\n        // 清除last frame\n        ctx.fillStyle = \"#000000\";\n        ctx.fillRect(0, 0, camera.screen[0], camera.screen[1]);\n    \n    // nested loops: y and x\n    for(let z = 0; z < mapTileData.levels; z++) {\n\t\tfor(let y = camera.startingPoint[1]; y <= camera.endingPoint[1]; ++y) {\n\t\t    for(let x = camera.startingPoint[0]; x <= camera.endingPoint[0]; ++x) {\n                if(z==0) {\n                let tile = tileTypes[mapTileData.map[toIndex(x,y)].type];\n\n\t\t\t    ctx.drawImage(gametile,\n\t\t\t\ttile.sprite[0].x, tile.sprite[0].y, tile.sprite[0].w, tile.sprite[0].h,\n\t\t\t\tcamera.offset[0] + (x * tileWidth), camera.offset[1] + (y * tileHeight),\n                tileWidth, tileHeight);\n                }\n            let o = mapTileData.map[toIndex(x,y)].object;\n\t\t\tif(o!=null && objectTypes[o.type].zIndex==z)\n\t\t\t{\n\t\t\t\tlet ot = objectTypes[o.type];\n\t\t\t\t \n\t\t\t\tctx.drawImage(gametile,\n\t\t\t\t\tot.sprite[0].x, ot.sprite[0].y,\n\t\t\t\t\tot.sprite[0].w, ot.sprite[0].h,\n\t\t\t\t\tcamera.offset[0] + (x*tileWidth) + ot.offset[0],\n\t\t\t\t\tcamera.offset[1] + (y*tileHeight) + ot.offset[1],\n\t\t\t\t\tot.sprite[0].w, ot.sprite[0].h);\n\t\t\t}\n\n               if(z == 2 && mapTileData.map[toIndex(x,y)].buildingType!=0 &&\n\t\t\t\tmapTileData.map[toIndex(x,y)].building!=miumiuBuilding1 &&\n\t\t\t\tmapTileData.map[toIndex(x,y)].building!=miumiuBuilding2) {\n                    tile = tileTypes[mapTileData.map[toIndex(x,y)].buildingType];\n                    sprite = getFrame(tile.sprite, tile.spritetimeLast,\n                        tile.animation);\n                    ctx.drawImage(gametile,\n                        sprite.x, sprite.y, sprite.w, sprite.h,\n                        camera.offset[0] + (x * tileWidth),\n                        camera.offset[1] + (y * tileHeight),\n                        tileWidth, tileHeight);\n\t\t\t}\n\t\t}\n    }\n\n    if(z==1)\n\t\t{\n\t\t\tlet sprite = miumiu.sprites[miumiu.direction];\n\t\t\tctx.drawImage(gametile,\n\t\t\t\tsprite[0].x, sprite[0].y,\n\t\t\t\tsprite[0].w, sprite[0].h,\n\t\t\t\tcamera.offset[0] + miumiu.position[0],\n\t\t\t\tcamera.offset[1] + miumiu.position[1],\n\t\t\t\tmiumiu.dimensions[0], miumiu.dimensions[1]);\n\t\t}\n\t\n\t}\n    \n    // draw the miumiu\n    let sprite = miumiu.sprites[miumiu.direction];\n\tctx.drawImage(gametile,\n\t\tsprite[0].x, sprite[0].y, sprite[0].w, sprite[0].h,\n\t\tcamera.offset[0] + miumiu.position[0], camera.offset[1] + miumiu.position[1],\n\t\tmiumiu.dimensions[0], miumiu.dimensions[1]);\n\n\n\tlastFrameTime = currentFrameTime;\n\trequestAnimationFrame(drawGame);\n}\n"],"sourceRoot":""}